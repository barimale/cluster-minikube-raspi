
pool:
  name: 'Default'
  demands:
    - agent.name -equals raspberrypi

steps:
- script: |
    sudo apt install git-all -y
  displayName: 'Install Git'
- script: |
    #sudo apt install docker.io -y
    #sudo usermod -aG docker $USER && newgrp docker
  displayName: 'npm build'
- script: |
    wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash
    source ~/.bashrc
    export NVM_DIR="$HOME/.nvm" [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh" 
    [ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"
    nvm install 14.21.3
  displayName: 'Install nvm'
- script: |
    sudo apt-get install snapd -y
    source ~/.bashrc
  displayName: 'Install snap'
- script: |
    sudo snap install microk8s --classic
  displayName: 'Install microk8s'
  continueOnError: true

